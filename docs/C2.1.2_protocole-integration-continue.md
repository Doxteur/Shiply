## Protocole d’intégration continue (C2.1.2)

### Objectifs
- Standardiser la qualité (typecheck, lint, tests, sécurité, a11y) avant tout merge.
- Offrir un feedback rapide et des artefacts utilisables.

### Pipeline CI (mono‑repo)
Voici le pipeline CI qui est exécuté par défaut sur PR → `develop` et `main`:
1) Install des workspaces via `turbo` et `bun install`.
2) Typecheck TypeScript strict sur `client`, `server`, `shared`, `runner`.
3) Lint ESLint + Prettier.
4) Tests unitaires:
   - Front: Vitest + React Testing Library + axe (a11y).
   - API: Japa/Jest + supertest.
   - Runner: tests d’intégration ciblés (les tests sont présent sur l'API).
   - Couverture: objectif ≥ 80% sur modules modifiés.
5) Build images Docker (client/api/runner) + analyse Trivy (vulnérabilités).
6) Lighthouse CI (front) via extension chrome.
7) Upload artefacts, utilisation de DockerHub.

### Gating
- Merge bloqué si: typecheck/lint/tests échouent, couverture < 80% sur modules touchés.
- Scan sécurité (Trivy) réussi.

### Conventions Git
- GitFlow obligatoire. Conventional Commits.
- PR obligatoire vers `develop`/`main` avec checklist CI verte.

### Cache & Performance
- Cache `turbo` pour builds/test. Cache dépendances Docker.

### Fichiers/Scripts
- `turbo.json`: pipelines monorepo.
- `docker-compose.yml`: conteneurisation de l'application.
- GitHub Actions: `ci.yml` et `cd.yml`.
- Scripts `package.json` cohérents.
